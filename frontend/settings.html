<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-LibraryAI - Home</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="theme.css">
    <script src="side-bar.js" defer></script>
    <script src="common.js" defer></script>
    <script src="chat.js" defer></script>
    <script src="settings.js" defer></script>
    
    <style>
        /* Settings Section */
        .settings-section {
            background-color: var(--secondary-bg, #242424);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            color: var(--text-color, white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color, #333);
            transition: border-color 0.3s ease;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        /* Switch Styles */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--tertiary-bg, #333);
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--highlight-color, #1a73e8);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Dropdown and Input Styles */
        select, input[type="text"] {
            background-color: var(--tertiary-bg, #333);
            border: 1px solid var(--border-color, #444);
            color: var(--text-color, white);
            padding: 8px 12px;
            border-radius: 5px;
            width: 200px;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--highlight-color, #1a73e8);
        }

        /* Quick Actions */
        .quick-actions {
            background-color: var(--tertiary-bg, #333);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            transition: background-color 0.3s ease;
        }

        .action-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            cursor: pointer;
            color: var(--text-color, white);
            transition: background-color 0.3s ease;
            border-radius: 5px;
        }

        .action-item:hover {
            background-color: var(--secondary-bg, #444);
        }

        /* Reading Mode Selector */
        .reading-mode-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color, #333);
            transition: border-color 0.3s ease;
        }

        /* Status message */
        .status-message {
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            text-align: center;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-message.success {
            background-color: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.5);
            color: #2da44e;
        }

        .status-message.error {
            background-color: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.5);
            color: #ff4d6d;
        }
        
        /* Theme toggle styles */
        .theme-toggle-container {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .theme-toggle-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.3s ease, border-color 0.3s ease;
        }

        .theme-toggle-btn:hover {
            transform: scale(1.1);
        }

        .theme-toggle-btn.active-theme {
            border-color: var(--highlight-color, #1a73e8);
        }

        .theme-toggle-dark {
            background-color: #1a1a1a;
        }

        .theme-toggle-light {
            background-color: #f5f5f5;
        }

        .theme-toggle-sepia {
            background-color: #f4ecd8;
        }
        
        /* Save Button Pulse Animation */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .save-pulse {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <img src="https://www.gutenberg.org/pics/pg-logo-002.png" alt="Logo">
            <span class="nav-text">E-LibraryAI</span>
        </div>
        <a href="home.html" class="nav-item">üè† <span class="nav-text">Home</span></a>
        <a href="search.html" class="nav-item">üîç <span class="nav-text">Search</span></a>
        <a href="recommendations.html" class="nav-item">üìö <span class="nav-text">Collections</span></a>
        
        <div style="margin-top: auto;">
            <a href="index.html" class="nav-item">üë§ <span class="nav-text">Profile</span></a>
            <a href="settings.html" class="nav-item">‚öôÔ∏è <span class="nav-text">Settings</span></a>
            <a href="login.html" class="nav-item">‚Ü™Ô∏è <span class="nav-text">Log Out</span></a>
        </div>
        <button class="collapse-btn">‚óÄ</button>
    </div>


    <div class="main-content">
        <div class="settings-header">
            <h1>Settings</h1>
        </div>

        <div class="status-message" id="statusMessage"></div>

        <div class="settings-section">
            <h2>Display Settings</h2>
            <!-- Theme selector -->
            <div class="setting-item">
                <span>Theme</span>
                <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 10px;">
                    <select name="theme" id="themeSelector">
                        <option value="dark">Dark</option>
                        <option value="light">Light</option>
                        <option value="sepia">Sepia</option>
                    </select>
                    
                    <!-- Visual Theme Toggle Buttons -->
                    <div class="theme-toggle-container">
                        <button class="theme-toggle-btn theme-toggle-dark" data-theme-toggle="dark" title="Dark Theme"></button>
                        <button class="theme-toggle-btn theme-toggle-light" data-theme-toggle="light" title="Light Theme"></button>
                        <button class="theme-toggle-btn theme-toggle-sepia" data-theme-toggle="sepia" title="Sepia Theme"></button>
                    </div>
                </div>
            </div>

            <!-- Font size selector -->
            <div class="setting-item">
                <span>Font Size</span>
                <select name="fontSize" id="fontSizeSelector">
                    <option value="small">Small</option>
                    <option value="medium">Medium</option>
                    <option value="large">Large</option>
                </select>
            </div>
            
            <!-- Add Reading Mode Selector -->
            <div class="reading-mode-container">
                <span>Reading Mode</span>
                <select id="readingMode">
                    <option value="continuous">Continuous</option>
                    <option value="paginated">Paginated</option>
                </select>
            </div>
        </div>

        <div class="settings-section">
            <h2>Account Settings</h2>
            <div class="setting-item">
                <span>Email Notifications</span>
                <label class="switch">
                    <input type="checkbox" id="emailNotifications" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>Reading Progress Tracking</span>
                <label class="switch">
                    <input type="checkbox" id="progressTracking" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>Language</span>
                <select id="languageSelector">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                </select>
            </div>
        </div>

        <div class="settings-section">
            <h2>AI Assistant Preferences</h2>
            <div class="setting-item">
                <span>AI Recommendations</span>
                <label class="switch">
                    <input type="checkbox" id="aiRecommendations" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>Reading Analysis</span>
                <label class="switch">
                    <input type="checkbox" id="readingAnalysis" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item">
                <span>AI Assistant Voice</span>
                <select id="aiVoice">
                    <option value="friendly">Friendly</option>
                    <option value="professional">Professional</option>
                    <option value="casual">Casual</option>
                </select>
            </div>
        </div>
        
        <button id="saveSettings" class="button" style="margin-top: 20px; padding: 10px 20px; background-color: var(--highlight-color); border: none; border-radius: 5px; color: white; cursor: pointer;">
            Save Settings
        </button>
        
        <button id="resetSettings" class="button" style="margin-top: 20px; margin-left: 10px; padding: 10px 20px; background-color: var(--tertiary-bg); border: 1px solid var(--border-color); border-radius: 5px; color: var(--text-color); cursor: pointer;">
            Reset to Defaults
        </button>
    </div>
    
    <div class="chat-panel">
        <button class="collapse-btn">‚ñ∂</button>
        <div class="chat-content">
            <div class="chat-header">
                <h2>AI Book Assistant</h2>
                <span>‚ñº</span>
            </div>
            
            <div class="chat-messages">
                <!-- Chat messages will appear here -->
            </div>

            <div class="chat-input">
                <input type="text" placeholder="Ask about settings...">
            </div>

            <div class="quick-actions">
                <h3>Quick Actions</h3>
                <div class="action-item" data-action="privacy">
                    üîí Privacy Settings
                </div>
                <div class="action-item" data-action="devices">
                    üì± Connected Devices
                </div>
                <div class="action-item" data-action="storage">
                    üíæ Data & Storage
                </div>
                <div class="action-item" data-action="sync">
                    üîÑ Sync Settings
                </div>
                <div class="action-item" data-action="about">
                    ‚ÑπÔ∏è About
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved settings
            loadSettings();
            
            // Save settings when button is clicked
            document.getElementById('saveSettings').addEventListener('click', saveAllSettings);
            
            // Reset settings when reset button is clicked
            document.getElementById('resetSettings').addEventListener('click', resetAllSettings);
            
            // Handle reading mode change
            document.getElementById('readingMode').addEventListener('change', function() {
                showStatus('Reading mode updated to ' + this.value, 'success');
            });
            
            // Handle quick actions
            document.querySelectorAll('.action-item').forEach(item => {
                item.addEventListener('click', function() {
                    const action = this.dataset.action;
                    handleQuickAction(action);
                });
            });
            
            // Handle theme toggle buttons
            document.querySelectorAll('.theme-toggle-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme-toggle');
                    if (theme) {
                        applyTheme(theme);
                        document.getElementById('themeSelector').value = theme;
                        highlightActiveThemeButton(theme);
                        showStatus(`Theme changed to ${theme}`, 'success');
                    }
                });
            });
            
            // Update theme button highlights when dropdown changes
            document.getElementById('themeSelector').addEventListener('change', function() {
                applyTheme(this.value);
                highlightActiveThemeButton(this.value);
                showStatus(`Theme changed to ${this.value}`, 'success');
            });
            
            // Send welcome message
            setTimeout(() => {
                const chatMessages = document.querySelector('.chat-messages');
                if (chatMessages && !chatMessages.querySelector('.message')) {
                    addBotMessage("Need help with your settings? I can guide you through customizing your E-LibraryAI experience.");
                }
            }, 500);
        });
        
        function loadSettings() {
            // Load theme
            const savedTheme = localStorage.getItem('e-libraryai-theme') || 'dark';
            document.getElementById('themeSelector').value = savedTheme;
            applyTheme(savedTheme);
            highlightActiveThemeButton(savedTheme);
            
            // Load font size
            const savedFontSize = localStorage.getItem('e-libraryai-font-size') || 'medium';
            document.getElementById('fontSizeSelector').value = savedFontSize;
            applyFontSize(savedFontSize);
            
            // Load other settings
            document.getElementById('emailNotifications').checked = 
                localStorage.getItem('e-libraryai-email-notifications') !== 'false';
            
            document.getElementById('progressTracking').checked = 
                localStorage.getItem('e-libraryai-progress-tracking') !== 'false';
            
            document.getElementById('aiRecommendations').checked = 
                localStorage.getItem('e-libraryai-ai-recommendations') !== 'false';
            
            document.getElementById('readingAnalysis').checked = 
                localStorage.getItem('e-libraryai-reading-analysis') !== 'false';
            
            const savedLanguage = localStorage.getItem('e-libraryai-language') || 'en';
            document.getElementById('languageSelector').value = savedLanguage;
            
            const savedReadingMode = localStorage.getItem('e-libraryai-reading-mode') || 'continuous';
            document.getElementById('readingMode').value = savedReadingMode;
            
            const savedAiVoice = localStorage.getItem('e-libraryai-ai-voice') || 'friendly';
            document.getElementById('aiVoice').value = savedAiVoice;
        }
        
        function saveAllSettings() {
            // Add pulse animation to save button
            const saveButton = document.getElementById('saveSettings');
            saveButton.classList.add('save-pulse');
            
            // Save theme
            const theme = document.getElementById('themeSelector').value;
            localStorage.setItem('e-libraryai-theme', theme);
            applyTheme(theme);
            
            // Save font size
            const fontSize = document.getElementById('fontSizeSelector').value;
            localStorage.setItem('e-libraryai-font-size', fontSize);
            applyFontSize(fontSize);
            
            // Save other settings
            localStorage.setItem('e-libraryai-email-notifications', 
                document.getElementById('emailNotifications').checked);
            
            localStorage.setItem('e-libraryai-progress-tracking', 
                document.getElementById('progressTracking').checked);
            
            localStorage.setItem('e-libraryai-ai-recommendations', 
                document.getElementById('aiRecommendations').checked);
            
            localStorage.setItem('e-libraryai-reading-analysis', 
                document.getElementById('readingAnalysis').checked);
            
            localStorage.setItem('e-libraryai-language', 
                document.getElementById('languageSelector').value);
            
            localStorage.setItem('e-libraryai-reading-mode', 
                document.getElementById('readingMode').value);
            
            localStorage.setItem('e-libraryai-ai-voice', 
                document.getElementById('aiVoice').value);
            
            // Show success message
            showStatus('Settings saved successfully!', 'success');
            
            // Add chat confirmation
            const chatMessages = document.querySelector('.chat-messages');
            if (chatMessages) {
                addBotMessage("Your settings have been updated successfully. They'll be applied across all your devices.");
            }
            
            // Remove pulse animation after a delay
            setTimeout(() => {
                saveButton.classList.remove('save-pulse');
            }, 2000);
        }
        
        function resetAllSettings() {
            if (confirm('Are you sure you want to reset all settings to default?')) {
                // Reset theme to dark
                localStorage.setItem('e-libraryai-theme', 'dark');
                document.getElementById('themeSelector').value = 'dark';
                applyTheme('dark');
                highlightActiveThemeButton('dark');
                
                // Reset font size to medium
                localStorage.setItem('e-libraryai-font-size', 'medium');
                document.getElementById('fontSizeSelector').value = 'medium';
                applyFontSize('medium');
                
                // Reset other settings to default values
                document.getElementById('emailNotifications').checked = true;
                localStorage.setItem('e-libraryai-email-notifications', true);
                
                document.getElementById('progressTracking').checked = true;
                localStorage.setItem('e-libraryai-progress-tracking', true);
                
                document.getElementById('aiRecommendations').checked = true;
                localStorage.setItem('e-libraryai-ai-recommendations', true);
                
                document.getElementById('readingAnalysis').checked = true;
                localStorage.setItem('e-libraryai-reading-analysis', true);
                
                document.getElementById('languageSelector').value = 'en';
                localStorage.setItem('e-libraryai-language', 'en');
                
                document.getElementById('readingMode').value = 'continuous';
                localStorage.setItem('e-libraryai-reading-mode', 'continuous');
                
                document.getElementById('aiVoice').value = 'friendly';
                localStorage.setItem('e-libraryai-ai-voice', 'friendly');
                
                // Show success message
                showStatus('All settings have been reset to default values', 'success');
                
                // Add chat confirmation
                const chatMessages = document.querySelector('.chat-messages');
                if (chatMessages) {
                    addBotMessage("I've reset all your settings to their default values. If you want to customize them again, feel free to make changes and save.");
                }
            }
        }
        
        function applyTheme(themeName) {
            // Apply theme using the improved theme manager functions
            if (window.setTheme) {
                window.setTheme(themeName);
            } else {
                // Fallback if setTheme isn't available
                document.body.setAttribute('data-theme', themeName);
                applyThemeVariables(themeName);
            }
        }
        
        function applyThemeVariables(themeName) {
            // Fallback theme variables if settings.js isn't loaded properly
            const themes = {
                dark: {
                    '--bg-color': '#1a1a1a',
                    '--secondary-bg': '#242424',
                    '--tertiary-bg': '#333',
                    '--text-color': '#ffffff',
                    '--secondary-text': '#cccccc',
                    '--border-color': '#444',
                    '--highlight-color': '#1a73e8',
                    '--card-bg': '#242424',
                    '--sidebar-bg': '#242424',
                    '--button-bg': '#333'
                },
                light: {
                    '--bg-color': '#f5f5f5',
                    '--secondary-bg': '#ffffff',
                    '--tertiary-bg': '#e0e0e0',
                    '--text-color': '#333333',
                    '--secondary-text': '#666666',
                    '--border-color': '#dddddd',
                    '--highlight-color': '#1a73e8',
                    '--card-bg': '#ffffff',
                    '--sidebar-bg': '#ffffff',
                    '--button-bg': '#e0e0e0'
                },
                sepia: {
                    '--bg-color': '#f4ecd8',
                    '--secondary-bg': '#e8dcb5',
                    '--tertiary-bg': '#d8cca3',
                    '--text-color': '#5b4636',
                    '--secondary-text': '#7d6045',
                    '--border-color': '#d0c49f',
                    '--highlight-color': '#986841',
                    '--card-bg': '#e8dcb5',
                    '--sidebar-bg': '#e8dcb5',
                    '--button-bg': '#d8cca3'
                }
            };
            
            if (themes[themeName]) {
                const root = document.documentElement;
                for (const [property, value] of Object.entries(themes[themeName])) {
                    root.style.setProperty(property, value);
                }
            }
        }
        
        function highlightActiveThemeButton(themeName) {
            // Update active state of theme toggle buttons
            document.querySelectorAll('.theme-toggle-btn').forEach(button => {
                if (button.getAttribute('data-theme-toggle') === themeName) {
                    button.classList.add('active-theme');
                } else {
                    button.classList.remove('active-theme');
                }
            });
        }
        
        function applyFontSize(size) {
            const root = document.documentElement;
            switch(size) {
                case 'small':
                    root.style.setProperty('--base-font-size', '14px');
                    break;
                case 'medium':
                    root.style.setProperty('--base-font-size', '16px');
                    break;
                case 'large':
                    root.style.setProperty('--base-font-size', '18px');
                    break;
            }
        }
        
        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = 'status-message ' + type;
            statusElement.style.display = 'block';
            
            // Hide after 3 seconds
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 3000);
        }
        
        function handleQuickAction(action) {
            let message;
            
            switch(action) {
                case 'privacy':
                    message = 'Privacy settings are coming soon.';
                    addBotMessage("Privacy settings allow you to control how your reading data is used. Currently, all your data is stored locally and isn't shared with anyone.");
                    break;
                case 'devices':
                    message = 'Device management is coming soon.';
                    addBotMessage("You can manage your connected devices and sync your reading progress between them. This feature is coming in the next update.");
                    break;
                case 'storage':
                    message = 'Data & storage settings are coming soon.';
                    addBotMessage("Data & storage settings let you control how much space the application uses on your device. Currently, we use browser storage for your preferences and reading history.");
                    break;
                case 'sync':
                    message = 'Sync settings are coming soon.';
                    addBotMessage("Sync settings allow your preferences and reading progress to be synchronized across all your devices. We're working on implementing this feature soon.");
                    break;
                case 'about':
                    message = 'E-LibraryAI v1.0.0 - Powered by Project Gutenberg';
                    addBotMessage("E-LibraryAI v1.0.0 is an AI-enhanced interface for Project Gutenberg's extensive collection of free e-books. Our mission is to make reading more accessible and enjoyable for everyone.");
                    break;
                default:
                    message = 'Feature coming soon!';
                    addBotMessage("This feature is still under development. Check back soon for updates!");
            }
            
            showStatus(message, 'success');
        }
        
        // Handle chat messages specifically for settings page
        document.querySelector('.chat-input input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && this.value.trim() !== '') {
                const userMessage = this.value.trim();
                addUserMessage(userMessage);
                
                // Process settings-specific queries
                if (userMessage.toLowerCase().includes('theme') || userMessage.toLowerCase().includes('dark') || userMessage.toLowerCase().includes('light')) {
                    setTimeout(() => {
                        addBotMessage("You can change the theme using the 'Theme' selector under Display Settings. We offer Dark, Light, and Sepia themes to suit your preferences and reduce eye strain. You can use either the dropdown or the color buttons for quick switching.");
                    }, 500);
                } else if (userMessage.toLowerCase().includes('font') || userMessage.toLowerCase().includes('size') || userMessage.toLowerCase().includes('text')) {
                    setTimeout(() => {
                        addBotMessage("You can adjust the font size in the Display Settings section. Choose from Small, Medium, or Large based on your reading comfort.");
                    }, 500);
                } else if (userMessage.toLowerCase().includes('notif') || userMessage.toLowerCase().includes('email')) {
                    setTimeout(() => {
                        addBotMessage("Email notifications can be toggled on or off in the Account Settings section. When enabled, you'll receive updates about new books and reading recommendations.");
                    }, 500);
                } else if (userMessage.toLowerCase().includes('save')) {
                    setTimeout(() => {
                        addBotMessage("To save your settings, scroll to the bottom of the page and click the 'Save Settings' button. This will store your preferences for future sessions.");
                    }, 500);
                } else if (userMessage.toLowerCase().includes('reset')) {
                    setTimeout(() => {
                        addBotMessage("You can reset all settings to their default values by clicking the 'Reset to Defaults' button at the bottom of the page. This will return everything to the way it was when you first started using E-LibraryAI.");
                    }, 500);
                } else {
                    // Default response
                    setTimeout(() => {
                        addBotMessage("I can help you configure your E-LibraryAI experience. Try asking about themes, font sizes, notifications, or any other settings you see on this page.");
                    }, 500);
                }
                
                this.value = '';
            }
        });
        
        // Chat message handler functions (if not defined in chat.js)
        if (typeof addUserMessage !== 'function') {
            function addUserMessage(text) {
                const chatMessages = document.querySelector('.chat-messages');
                if (!chatMessages) return;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user-message';
                
                const messagePara = document.createElement('p');
                messagePara.textContent = text;
                
                const timeSpan = document.createElement('span');
                timeSpan.className = 'message-time';
                timeSpan.textContent = 'You';
                
                messageDiv.appendChild(messagePara);
                messageDiv.appendChild(timeSpan);
                chatMessages.appendChild(messageDiv);
                
                // Scroll to the bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
        
        if (typeof addBotMessage !== 'function') {
            function addBotMessage(text) {
                const chatMessages = document.querySelector('.chat-messages');
                if (!chatMessages) return;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                
                // Create the header with avatar and name
                const headerDiv = document.createElement('div');
                headerDiv.style = 'display: flex; gap: 10px; align-items: center;';
                
                const avatar = document.createElement('img');
                avatar.src = 'https://ui-avatars.com/api/?name=AI&background=1a73e8&color=fff';
                avatar.alt = 'AI Assistant';
                avatar.style = 'border-radius: 50%; width: 40px; height: 40px;';
                
                const nameTimeDiv = document.createElement('div');
                
                const nameStrong = document.createElement('strong');
                nameStrong.textContent = 'BookBot';
                
                const timeSpan = document.createElement('span');
                timeSpan.className = 'message-time';
                timeSpan.textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                nameTimeDiv.appendChild(nameStrong);
                nameTimeDiv.appendChild(document.createTextNode(' '));
                nameTimeDiv.appendChild(timeSpan);
                
                headerDiv.appendChild(avatar);
                headerDiv.appendChild(nameTimeDiv);
                
                // Message content
                const messagePara = document.createElement('p');
                messagePara.textContent = text;
                
                // Assemble the message
                messageDiv.appendChild(headerDiv);
                messageDiv.appendChild(messagePara);
                
                chatMessages.appendChild(messageDiv);
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
    </script>
</body>
</html>